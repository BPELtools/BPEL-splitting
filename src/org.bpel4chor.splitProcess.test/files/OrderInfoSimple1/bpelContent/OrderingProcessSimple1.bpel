<!-- OrderingProcessSimple1 BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Mon Nov 07 20:51:05 CET 2011 -->
<bpel:process name="OrderingProcessSimple1"
	targetNamespace="http://www.iaas.uni-stuttgart.de" suppressJoinFailure="yes"
	xmlns:tns="http://www.iaas.uni-stuttgart.de" xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
	exitOnStandardFault="no" xmlns:ns1="http://www.w3.org/2001/XMLSchema"
	xmlns:ns3="http://www.iaas.uni-stuttgart.deArtifacts">

	<!-- Import the client WSDL -->
	<bpel:import namespace="http://www.iaas.uni-stuttgart.de"
		location="ProcessPayment.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import namespace="http://www.iaas.uni-stuttgart.de"
		location="ProcessOrder.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:import namespace="http://www.iaas.uni-stuttgart.de"
		location="TypeSchema.xsd" importType="http://www.w3.org/2001/XMLSchema"></bpel:import>
	<bpel:import namespace="http://www.iaas.uni-stuttgart.de"
		location="OrderingProcessSimple1.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>

	<!-- ================================================================= -->
	<!-- ORCHESTRATION LOGIC -->
	<!-- Set of activities coordinating the flow of messages across the -->
	<!-- services integrated within this business process -->
	<!-- ================================================================= -->
	<bpel:correlationSets>
		<bpel:correlationSet name="CorrelationSet"
			properties="tns:correlProperty"></bpel:correlationSet>
	</bpel:correlationSets>

	<bpel:partnerLinks>
		<bpel:partnerLink name="orderingPL" partnerLinkType="tns:OrderingProcessSimple1PT"
			myRole="OrderProcessProvider"></bpel:partnerLink>


	</bpel:partnerLinks>
	<bpel:variables>
		<bpel:variable name="orderInfo" messageType="tns:orderRequest"></bpel:variable>
		<bpel:variable name="paymentInfo" messageType="tns:processPaymentRequest"></bpel:variable>
    </bpel:variables>
	<bpel:flow name="Flow">
		<bpel:links>
			<bpel:link name="ReceiveA2AssignB"></bpel:link>
		</bpel:links>
		<bpel:receive name="ReceiveA" createInstance="yes"
			partnerLink="orderingPL" operation="order" portType="tns:OrderingProcessSimple1"
			variable="orderInfo">
			<bpel:sources>
				<bpel:source linkName="ReceiveA2AssignB">
                </bpel:source>
			</bpel:sources>
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="yes"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
		<bpel:assign validate="no" name="AssignB">
			<bpel:targets>
				<bpel:target linkName="ReceiveA2AssignB"></bpel:target>
			</bpel:targets>

			<bpel:copy>
				<bpel:from part="acountNumber" variable="orderInfo">
				</bpel:from>
				<bpel:to part="actNum" variable="paymentInfo">
				</bpel:to>
			</bpel:copy>
			
			<bpel:copy>
				<bpel:from>
                    <![CDATA[$orderInfo.orderTotalPrice + 5*$orderInfo.numDeliveries]]>
				</bpel:from>
				<bpel:to part="amt" variable="paymentInfo">
				</bpel:to>
			</bpel:copy>
		</bpel:assign>

	</bpel:flow>
</bpel:process>

